# 社团管理功能测试说明

## 概述
本文档说明如何测试已加入社团和管理社团页面的交互功能，包括退出社团和删除社团的操作。

## 测试环境
- 确保项目运行在开发模式下
- 确保API模式设置为Mock模式（默认）
- 访问地址：http://localhost:5173

## 功能测试

### 1. 已加入社团页面测试

#### 测试路径
1. 登录系统
2. 进入个人中心
3. 点击"已加入社团"菜单

#### 初始状态
- 页面显示3个已加入的社团：
  - 计算机科学协会（85/100人）
  - 摄影艺术社（60/60人）
  - 青年志愿者协会（150/150人）

#### 测试退出社团功能
1. 在任意社团卡片上点击"退出社团"按钮
2. 确认对话框会显示警告信息
3. 点击"确认退出"
4. 验证结果：
   - 显示"退出社团成功"消息
   - 该社团从列表中消失
   - 社团成员数量减少1
   - 用户统计信息中的已加入社团数量减少1

#### 预期行为
- 退出社团后，页面会自动刷新显示更新后的列表
- 如果退出所有社团，页面会显示空状态提示
- 退出操作有适当的加载状态和错误处理

### 2. 管理的社团页面测试

#### 测试路径
1. 登录系统
2. 进入个人中心
3. 点击"管理的社团"菜单

#### 初始状态
- 页面显示1个管理的社团：
  - 计算机科学协会（85/100人）

#### 测试删除社团功能
1. 在社团卡片上点击"删除社团"按钮
2. 确认对话框会显示警告信息
3. 点击"确认删除"
4. 验证结果：
   - 显示"社团删除成功"消息
   - 该社团从列表中消失
   - 如果用户也加入了该社团，已加入社团数量也会减少
   - 用户统计信息中的管理社团数量减少1

#### 测试创建社团功能
1. 点击"创建新社团"按钮
2. 填写社团信息：
   - 社团名称：测试社团
   - 社团简介：这是一个测试社团
   - 社团类型：学术科技
   - 最大成员数：50
   - 社团标签：测试、编程
3. 点击"创建社团"
4. 验证结果：
   - 显示"社团创建成功，等待审核"消息
   - 新社团出现在管理社团列表中
   - 新社团也出现在已加入社团列表中
   - 用户统计信息中的管理社团和已加入社团数量都增加1

#### 预期行为
- 删除社团后，页面会自动刷新显示更新后的列表
- 如果删除所有管理的社团，页面会显示空状态提示
- 创建社团后，新社团会立即出现在列表中
- 所有操作都有适当的加载状态和错误处理

## 数据状态管理

### Mock数据状态
- `userJoinedClubIds`: 存储用户加入的社团ID列表
- `userManagedClubIds`: 存储用户管理的社团ID列表
- `mockUser.stats`: 存储用户统计信息

### 状态更新规则
1. **退出社团**：
   - 从 `userJoinedClubIds` 中移除社团ID
   - 减少社团的 `currentMembers` 数量
   - 减少 `mockUser.stats.joinedClubs` 数量

2. **删除社团**：
   - 从 `userManagedClubIds` 中移除社团ID
   - 从 `userJoinedClubIds` 中移除社团ID（如果存在）
   - 从 `mockClubs` 数组中移除社团对象
   - 减少 `mockUser.stats.managedClubs` 数量
   - 减少 `mockUser.stats.joinedClubs` 数量（如果用户也加入了该社团）

3. **创建社团**：
   - 向 `mockClubs` 数组中添加新社团对象
   - 向 `userManagedClubIds` 中添加社团ID
   - 向 `userJoinedClubIds` 中添加社团ID
   - 增加 `mockUser.stats.managedClubs` 数量
   - 增加 `mockUser.stats.joinedClubs` 数量

## 错误处理测试

### 测试场景
1. **网络错误模拟**：在mock函数中添加延迟和错误抛出
2. **权限验证**：尝试删除不属于用户管理的社团
3. **数据一致性**：验证状态更新是否正确

### 预期错误处理
- 显示适当的错误消息
- 操作失败时不会更新页面状态
- 加载状态正确显示和隐藏

## 注意事项

1. **数据持久性**：Mock数据在页面刷新后会重置到初始状态
2. **并发操作**：避免同时进行多个操作，可能导致数据不一致
3. **浏览器兼容性**：确保在不同浏览器中功能正常

## 调试技巧

1. 打开浏览器开发者工具查看控制台日志
2. 使用Vue DevTools查看组件状态
3. 在mock函数中添加console.log来跟踪数据变化
4. 检查网络请求是否正确调用mock函数

## 扩展功能

未来可以考虑添加的功能：
1. 批量操作（批量退出、批量删除）
2. 操作历史记录
3. 数据导出功能
4. 更详细的权限控制 